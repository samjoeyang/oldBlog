---
layout: post
status: publish
published: true
title: Ajax原理详细说明(转自ibm开发者网站) (二)
author:
  display_name: Samjoe Yang
  login: blogerlogin
  email: youremail@example.com
  url: http://needis.me
author_login: blogerlogin
author_email: youremail@example.com
author_url: http://needis.me
wordpress_id: 15
wordpress_url: http://samjoeyang.wordpress.com/2006/04/25/ajax%e5%8e%9f%e7%90%86%e8%af%a6%e7%bb%86%e8%af%b4%e6%98%8e%e8%bd%ac%e8%87%aaibm%e5%bc%80%e5%8f%91%e8%80%85%e7%bd%91%e7%ab%99-%e4%ba%8c
date: '2006-04-25 05:10:57 +0800'
date_gmt: '2006-04-25 05:10:57 +0800'
categories:
- Internet
- JAVASCRIPT
- Programmers
tags:
- 进阶
- Ajax
- 原理
comments: []
---
<div id="msgcns!A634C4CD7A14B666!294" class="bvMsg">
<div>
<div style="line-height:14.25pt;" align="left"><a><strong><span style="font-size:13.5pt;color:black;font-family:宋体;">获取</span></strong></a><strong><span style="font-size:13.5pt;color:black;font-family:Arial;"> Request </span></strong><strong><span style="font-size:13.5pt;color:black;font-family:宋体;">对象</span></strong></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">有了上面的基础知识后，我们来看看一些具体的例子。</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">是</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">应用程序的核心，而且对很多读者来说可能还比较陌生，我们就从这里开始吧。从</span><span style="font-size:9pt;color:black;font-family:Verdana;"> <a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#code1#code1"><span style="font-family:宋体;"><font face="宋体"><u><font color="#0000ff"><span>清单</span> 1</font></u></font></span></a> </span><span style="font-size:9pt;color:black;font-family:宋体;">可以看出，创建和使用这个对象非常简单，不是吗？等一等。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">还记得几年前的那些讨厌的浏览器战争吗？没有一样东西在不同的浏览器上得到同样的结果。不管您是否相信，这些战争仍然在继续，虽然规模较小。但令人奇怪的是，</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">成了这场战争的牺牲品之一。因此获得</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">对象可能需要采用不同的方法。下面我将详细地进行解释。</span></div>
<div style="line-height:14.25pt;" align="left"><a><strong><span style="font-size:11.5pt;color:black;font-family:宋体;">使用</span></strong></a><strong><span style="font-size:11.5pt;color:black;font-family:Arial;"> Microsoft </span></strong><strong><span style="font-size:11.5pt;color:black;font-family:宋体;">浏览器</span></strong></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:Verdana;">Microsoft </span><span style="font-size:9pt;color:black;font-family:宋体;">浏览器</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Internet Explorer </span><span style="font-size:9pt;color:black;font-family:宋体;">使用</span><span style="font-size:9pt;color:black;font-family:Verdana;"> MSXML </span><span style="font-size:9pt;color:black;font-family:宋体;">解析器处理</span><span style="font-size:9pt;color:black;font-family:Verdana;"> XML</span><span style="font-size:9pt;color:black;font-family:宋体;">（可以通过</span><span style="font-size:9pt;color:black;font-family:Verdana;"> <a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#resources#resources"><span style="font-family:宋体;"><span><u><font face="宋体" color="#0000ff">参考资料</font></u></span></span></a> </span><span style="font-size:9pt;color:black;font-family:宋体;">进一步了解</span><span style="font-size:9pt;color:black;font-family:Verdana;"> MSXML</span><span style="font-size:9pt;color:black;font-family:宋体;">）。因此如果编写的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">应用程序要和</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Internet Explorer </span><span style="font-size:9pt;color:black;font-family:宋体;">打交道，那么必须用一种特殊的方式创建对象。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">但并不是这么简单。根据</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Internet Explorer </span><span style="font-size:9pt;color:black;font-family:宋体;">中安装的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> JavaScript </span><span style="font-size:9pt;color:black;font-family:宋体;">技术版本不同，</span><span style="font-size:9pt;color:black;font-family:Verdana;">MSXML </span><span style="font-size:9pt;color:black;font-family:宋体;">实际上有两种不同的版本，因此必须对这两种情况分别编写代码。请参阅</span><span style="font-size:9pt;color:black;font-family:Verdana;"> <a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#code3#code3"><span style="font-family:宋体;"><font face="宋体"><u><font color="#0000ff"><span>清单</span> 3</font></u></font></span></a></span><span style="font-size:9pt;color:black;font-family:宋体;">，其中的代码在</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Microsoft </span><span style="font-size:9pt;color:black;font-family:宋体;">浏览器上创建了一个</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:Verdana;"><br /></span><a><strong><span style="font-size:9pt;color:black;font-family:宋体;">清单</span></strong></a><strong><span style="font-size:9pt;color:black;font-family:Verdana;"> 3. </span></strong><strong><span style="font-size:9pt;color:black;font-family:宋体;">在</span></strong><strong><span style="font-size:9pt;color:black;font-family:Verdana;"> Microsoft </span></strong><strong><span style="font-size:9pt;color:black;font-family:宋体;">浏览器上创建</span></strong><strong><span style="font-size:9pt;color:black;font-family:Verdana;"> XMLHttpRequest </span></strong><strong><span style="font-size:9pt;color:black;font-family:宋体;">对象</span></strong></div>
<table style="background:#eeeeee;width:100%;" cellspacing="0" cellpadding="0" width="100%" border="1">
<tbody>
<tr>
<td>
<div style="line-height:14.25pt;text-align:left;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">var xmlHttp = false;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">try &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&#125; catch (e) &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;try &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&nbsp;&nbsp; xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&#125; catch (e2) &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&nbsp;&nbsp; xmlHttp = false;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&#125;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&#125;</span></div>
</td>
</tr>
</tbody>
</table>
<div style="line-height:14.25pt;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">您对这些代码可能还不完全理解，但没有关系。当本系列文章结束的时候，您将对</span><span style="font-size:9pt;color:black;font-family:Verdana;"> JavaScript </span><span style="font-size:9pt;color:black;font-family:宋体;">编程、错误处理、条件编译等有更深的了解。现在只要牢牢记住其中的两行代码：</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:12pt;color:black;font-family:宋体;">xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">和</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:12pt;color:black;font-family:宋体;">xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");</span><span style="font-size:9pt;color:black;font-family:宋体;">。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">这两行代码基本上就是尝试使用一个版本的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> MSXML </span><span style="font-size:9pt;color:black;font-family:宋体;">创建对象，如果失败则使用另一个版本创建该对象。不错吧？如果都不成功，则将</span><span style="font-size:12pt;color:black;font-family:宋体;">xmlHttp</span><span style="font-size:9pt;color:black;font-family:宋体;">变量设为</span><span style="font-size:9pt;color:black;font-family:Verdana;"> false</span><span style="font-size:9pt;color:black;font-family:宋体;">，告诉您的代码出现了问题。如果出现这种情况，可能是因为安装了非</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Microsoft </span><span style="font-size:9pt;color:black;font-family:宋体;">浏览器，需要使用不同的代码。</span></div>
<div style="line-height:14.25pt;" align="left"><a><strong><span style="font-size:11.5pt;color:black;font-family:宋体;">处理</span></strong></a><strong><span style="font-size:11.5pt;color:black;font-family:Arial;"> Mozilla </span></strong><strong><span style="font-size:11.5pt;color:black;font-family:宋体;">和非</span></strong><strong><span style="font-size:11.5pt;color:black;font-family:Arial;"> Microsoft </span></strong><strong><span style="font-size:11.5pt;color:black;font-family:宋体;">浏览器</span></strong></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">如果选择的浏览器不是</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Internet Explorer</span><span style="font-size:9pt;color:black;font-family:宋体;">，或者为非</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Microsoft </span><span style="font-size:9pt;color:black;font-family:宋体;">浏览器编写代码，就需要使用不同的代码。事实上就是</span><span style="font-size:9pt;color:black;font-family:Verdana;"> <a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#code1#code1"><span style="font-family:宋体;"><font face="宋体"><u><font color="#0000ff"><span>清单</span> 1</font></u></font></span></a> </span><span style="font-size:9pt;color:black;font-family:宋体;">所示的一行简单代码：</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:12pt;color:black;font-family:宋体;">var xmlHttp = new XMLHttpRequest object;</span><span style="font-size:9pt;color:black;font-family:宋体;">。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">这行简单得多的代码在</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Mozilla</span><span style="font-size:9pt;color:black;font-family:宋体;">、</span><span style="font-size:9pt;color:black;font-family:Verdana;">Firefox</span><span style="font-size:9pt;color:black;font-family:宋体;">、</span><span style="font-size:9pt;color:black;font-family:Verdana;">Safari</span><span style="font-size:9pt;color:black;font-family:宋体;">、</span><span style="font-size:9pt;color:black;font-family:Verdana;">Opera </span><span style="font-size:9pt;color:black;font-family:宋体;">以及基本上所有以任何形式或方式支持</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">的非</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Microsoft </span><span style="font-size:9pt;color:black;font-family:宋体;">浏览器中，创建了</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">对象。</span></div>
<div style="line-height:14.25pt;" align="left"><a><strong><span style="font-size:11.5pt;color:black;font-family:宋体;">结合起来</span></strong></a></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">关键是要支持<em>所有</em></span><span style="font-size:9pt;color:black;font-family:宋体;">浏览器。谁愿意编写一个只能用于</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Internet Explorer </span><span style="font-size:9pt;color:black;font-family:宋体;">或者非</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Microsoft </span><span style="font-size:9pt;color:black;font-family:宋体;">浏览器的应用程序呢？或者更糟，要编写一个应用程序两次？当然不！因此代码要同时支持</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Internet Explorer </span><span style="font-size:9pt;color:black;font-family:宋体;">和非</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Microsoft </span><span style="font-size:9pt;color:black;font-family:宋体;">浏览器。</span><span style="font-size:9pt;color:black;font-family:Verdana;"><a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#code4#code4"><u><font color="#0000ff"><span style="font-family:宋体;">清单</span> 4</font></u></a> </span><span style="font-size:9pt;color:black;font-family:宋体;">显示了这样的代码。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:Verdana;"><br /></span><a><strong><span style="font-size:9pt;color:black;font-family:宋体;">清单</span></strong></a><strong><span style="font-size:9pt;color:black;font-family:Verdana;"> 4. </span></strong><strong><span style="font-size:9pt;color:black;font-family:宋体;">以支持多种浏览器的方式创建</span></strong><strong><span style="font-size:9pt;color:black;font-family:Verdana;"> XMLHttpRequest </span></strong><strong><span style="font-size:9pt;color:black;font-family:宋体;">对象</span></strong></div>
<table style="background:#eeeeee;width:100%;" cellspacing="0" cellpadding="0" width="100%" border="1">
<tbody>
<tr>
<td>
<div style="line-height:14.25pt;text-align:left;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">-- Create a new XMLHttpRequest object to talk to the Web server */</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">var xmlHttp = false;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">--@cc_on @*/</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">--@if (@_jscript_version >= 5)</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">try &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&#125; catch (e) &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;try &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&nbsp;&nbsp; xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&#125; catch (e2) &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&nbsp;&nbsp; xmlHttp = false;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&#125;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&#125;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">@end @*/</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">if (!xmlHttp &amp;&amp; typeof XMLHttpRequest != 'undefined') &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;xmlHttp = new XMLHttpRequest();</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&#125;</span></div>
</td>
</tr>
</tbody>
</table>
<div style="line-height:14.25pt;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">现在先不管那些注释掉的奇怪符号，如</span><span style="font-size:12pt;color:black;font-family:宋体;">@cc_on</span><span style="font-size:9pt;color:black;font-family:宋体;">，这是特殊的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> JavaScript </span><span style="font-size:9pt;color:black;font-family:宋体;">编译器命令，将在下一期针对</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">的文章中详细讨论。这段代码的核心分为三步：</span></div>
<div align="left"><span style="font-size:9pt;color:black;font-family:Arial;">1.<span style="font:7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9pt;color:black;font-family:宋体;">建立一个变量</span><span style="font-size:12pt;color:black;font-family:宋体;">xmlHttp</span><span style="font-size:9pt;color:black;font-family:宋体;">来引用即将创建的</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">对象。</span></div>
<div align="left"><span style="font-size:9pt;color:black;font-family:Arial;">2.<span style="font:7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9pt;color:black;font-family:宋体;">尝试在</span><span style="font-size:9pt;color:black;font-family:Arial;"> Microsoft </span><span style="font-size:9pt;color:black;font-family:宋体;">浏览器中创建该对象：</span></div>
<div align="left"><span style="font-size:10pt;color:black;font-family:'Courier New';">o<span style="font:7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9pt;color:black;font-family:宋体;">尝试使用</span><span style="font-size:12pt;color:black;font-family:宋体;">Msxml2.XMLHTTP</span><span style="font-size:9pt;color:black;font-family:宋体;">对象创建它。</span></div>
<div align="left"><span style="font-size:10pt;color:black;font-family:'Courier New';">o<span style="font:7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9pt;color:black;font-family:宋体;">如果失败，再尝试</span><span style="font-size:12pt;color:black;font-family:宋体;">Microsoft.XMLHTTP</span><span style="font-size:9pt;color:black;font-family:宋体;">对象。</span></div>
<div align="left"><span style="font-size:9pt;color:black;font-family:Arial;">3.<span style="font:7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9pt;color:black;font-family:宋体;">如果仍然没有建立</span><span style="font-size:12pt;color:black;font-family:宋体;">xmlHttp</span><span style="font-size:9pt;color:black;font-family:宋体;">，则以非</span><span style="font-size:9pt;color:black;font-family:Arial;"> Microsoft </span><span style="font-size:9pt;color:black;font-family:宋体;">的方式创建该对象。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">最后，</span><span style="font-size:12pt;color:black;font-family:宋体;">xmlHttp</span><span style="font-size:9pt;color:black;font-family:宋体;">应该引用一个有效的</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">对象，无论运行什么样的浏览器。</span></div>
<div style="line-height:14.25pt;" align="left"><a><strong><span style="font-size:11.5pt;color:black;font-family:宋体;">关于安全性的一点说明</span></strong></a></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">安全性如何呢？现在浏览器允许用户提高他们的安全等级，关闭</span><span style="font-size:9pt;color:black;font-family:Verdana;"> JavaScript </span><span style="font-size:9pt;color:black;font-family:宋体;">技术，禁用浏览器中的任何选项。在这种情况下，代码无论如何都不会工作。此时必须适当地处理问题，这需要单独的一篇文章来讨论，要放到以后了（这个系列够长了吧？不用担心，读完之前也许您就掌握了）。现在要编写一段健壮但不够完美的代码，对于掌握</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">来说就很好了。以后我们还将讨论更多的细节。</span></div>
<div style="line-height:14.25pt;" align="left">&nbsp;</div>
<table style="width:100%;" cellspacing="0" cellpadding="0" width="100%" border="0">
<tbody>
<tr></tr>
</tbody>
</table>
<table cellspacing="0" cellpadding="0" align="right" border="0">
<tbody>
<tr>
<td>
<div align="right">
<table cellspacing="0" cellpadding="0" border="0">
<tbody>
<tr>
<td valign="top">
<div style="line-height:14.25pt;" align="right"><span style="font-size:9pt;color:black;font-family:Verdana;"><a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#main#main"><strong><span style="font-family:宋体;text-decoration:none;"><font color="#0000ff">回页首</font></span></strong></a></span></div>
</td>
</tr>
</tbody>
</table>
</div>
</td>
</tr>
</tbody>
</table>
<div align="left">&nbsp;</div>
<div style="line-height:14.25pt;" align="left"><a><strong><span style="font-size:13.5pt;color:black;font-family:Arial;">Ajax </span></strong></a><strong><span style="font-size:13.5pt;color:black;font-family:宋体;">世界中的请求</span></strong><strong><span style="font-size:13.5pt;color:black;font-family:Arial;">/</span></strong><strong><span style="font-size:13.5pt;color:black;font-family:宋体;">响应</span></strong></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">现在我们介绍了</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax</span><span style="font-size:9pt;color:black;font-family:宋体;">，对</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">对象以及如何创建它也有了基本的了解。如果阅读得很仔细，您可能已经知道与服务器上的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Web </span><span style="font-size:9pt;color:black;font-family:宋体;">应用程序打交道的是</span><span style="font-size:9pt;color:black;font-family:Verdana;"> JavaScript </span><span style="font-size:9pt;color:black;font-family:宋体;">技术，而不是直接提交给那个应用程序的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> HTML </span><span style="font-size:9pt;color:black;font-family:宋体;">表单。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">还缺少什么呢？到底如何使用</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">。因为这段代码非常重要，您编写的<em>每个</em></span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">应用程序都要以某种形式使用它，先看看</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">的基本请求</span><span style="font-size:9pt;color:black;font-family:Verdana;">/</span><span style="font-size:9pt;color:black;font-family:宋体;">响应模型是什么样吧。</span></div>
<div style="line-height:14.25pt;" align="left"><a><strong><span style="font-size:11.5pt;color:black;font-family:宋体;">发出请求</span></strong></a></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">您已经有了一个崭新的</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">对象，现在让它干点活儿吧。首先需要一个</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Web </span><span style="font-size:9pt;color:black;font-family:宋体;">页面能够调用的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> JavaScript </span><span style="font-size:9pt;color:black;font-family:宋体;">方法（比如当用户输入文本或者从菜单中选择一项时）。接下来就是在所有</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">应用程序中基本都雷同的流程：</span></div>
<div align="left"><span style="font-size:9pt;color:black;font-family:Arial;">1.<span style="font:7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9pt;color:black;font-family:宋体;">从</span><span style="font-size:9pt;color:black;font-family:Arial;"> Web </span><span style="font-size:9pt;color:black;font-family:宋体;">表单中获取需要的数据。</span></div>
<div align="left"><span style="font-size:9pt;color:black;font-family:Arial;">2.<span style="font:7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9pt;color:black;font-family:宋体;">建立要连接的</span><span style="font-size:9pt;color:black;font-family:Arial;"> URL</span><span style="font-size:9pt;color:black;font-family:宋体;">。</span></div>
<div align="left"><span style="font-size:9pt;color:black;font-family:Arial;">3.<span style="font:7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9pt;color:black;font-family:宋体;">打开到服务器的连接。</span></div>
<div align="left"><span style="font-size:9pt;color:black;font-family:Arial;">4.<span style="font:7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9pt;color:black;font-family:宋体;">设置服务器在完成后要运行的函数。</span></div>
<div align="left"><span style="font-size:9pt;color:black;font-family:Arial;">5.<span style="font:7pt 'Times New Roman';">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9pt;color:black;font-family:宋体;">发送请求。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:Verdana;"><a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#code5#code5"><u><font color="#0000ff"><span style="font-family:宋体;">清单</span> 5</font></u></a> </span><span style="font-size:9pt;color:black;font-family:宋体;">中的示例</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">方法就是按照这个顺序组织的：</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:Verdana;"><br /></span><a><strong><span style="font-size:9pt;color:black;font-family:宋体;">清单</span></strong></a><strong><span style="font-size:9pt;color:black;font-family:Verdana;"> 5. </span></strong><strong><span style="font-size:9pt;color:black;font-family:宋体;">发出</span></strong><strong><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span></strong><strong><span style="font-size:9pt;color:black;font-family:宋体;">请求</span></strong></div>
<table style="background:#eeeeee;width:100%;" cellspacing="0" cellpadding="0" width="100%" border="1">
<tbody>
<tr>
<td>
<div style="line-height:14.25pt;text-align:left;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">function callServer() &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;// Get the city and state from the web form</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;var city = document.getElementById("city").value;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;var state = document.getElementById("state").value;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;// Only go on if there are values for both fields</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;if ((city == null) || (city == "")) return;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;if ((state == null) || (state == "")) return;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;// Build the URL to connect to</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;var url = "/scripts/getZipCode.php?city=" + escape(city) + "&amp;state=" + escape(state);</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;// Open a connection to the server</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;xmlHttp.open("GET", url, true);</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;// Setup a function for the server to run when it's done</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;xmlHttp.onreadystatechange = updatePage;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;// Send the request</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;xmlHttp.send(null);</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&#125;</span></div>
</td>
</tr>
</tbody>
</table>
<div style="line-height:14.25pt;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">其中大部分代码意义都很明确。开始的代码使用基本</span><span style="font-size:9pt;color:black;font-family:Verdana;"> JavaScript </span><span style="font-size:9pt;color:black;font-family:宋体;">代码获取几个表单字段的值。然后设置一个</span><span style="font-size:9pt;color:black;font-family:Verdana;"> PHP </span><span style="font-size:9pt;color:black;font-family:宋体;">脚本作为链接的目标。要注意脚本</span><span style="font-size:9pt;color:black;font-family:Verdana;"> URL </span><span style="font-size:9pt;color:black;font-family:宋体;">的指定方式，</span><span style="font-size:9pt;color:black;font-family:Verdana;">city </span><span style="font-size:9pt;color:black;font-family:宋体;">和</span><span style="font-size:9pt;color:black;font-family:Verdana;"> state</span><span style="font-size:9pt;color:black;font-family:宋体;">（来自表单）使用简单的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> GET </span><span style="font-size:9pt;color:black;font-family:宋体;">参数附加在</span><span style="font-size:9pt;color:black;font-family:Verdana;"> URL </span><span style="font-size:9pt;color:black;font-family:宋体;">之后。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">然后打开一个连接，这是您第一次看到使用</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">。其中指定了连接方法（</span><span style="font-size:9pt;color:black;font-family:Verdana;">GET</span><span style="font-size:9pt;color:black;font-family:宋体;">）和要连接的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> URL</span><span style="font-size:9pt;color:black;font-family:宋体;">。最后一个参数如果设为</span><span style="font-size:12pt;color:black;font-family:宋体;">true</span><span style="font-size:9pt;color:black;font-family:宋体;">，那么将请求一个异步连接（这就是</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">的由来）。如果使用</span><span style="font-size:12pt;color:black;font-family:宋体;">false</span><span style="font-size:9pt;color:black;font-family:宋体;">，那么代码发出请求后将等待服务器返回的响应。如果设为</span><span style="font-size:12pt;color:black;font-family:宋体;">true</span><span style="font-size:9pt;color:black;font-family:宋体;">，当服务器在后台处理请求的时候用户仍然可以使用表单（甚至调用其他</span><span style="font-size:9pt;color:black;font-family:Verdana;"> JavaScript </span><span style="font-size:9pt;color:black;font-family:宋体;">方法）。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:12pt;color:black;font-family:宋体;">xmlHttp</span><span style="font-size:9pt;color:black;font-family:宋体;">（要记住，这是</span><span style="font-size:12pt;color:black;font-family:宋体;">XMLHttpRequest</span><span style="font-size:9pt;color:black;font-family:宋体;">对象实例）的</span><span style="font-size:12pt;color:black;font-family:宋体;">onreadystatechange</span><span style="font-size:9pt;color:black;font-family:宋体;">属性可以告诉服务器在运行<em>完成</em></span><span style="font-size:9pt;color:black;font-family:宋体;">后（可能要用五分钟或者五个小时）做什么。因为代码没有等待服务器，必须让服务器知道怎么做以便您能作出响应。在这个示例中，如果服务器处理完了请求，一个特殊的名为</span><span style="font-size:12pt;color:black;font-family:宋体;">updatePage()</span><span style="font-size:9pt;color:black;font-family:宋体;">的方法将被触发。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">最后，使用值</span><span style="font-size:12pt;color:black;font-family:宋体;">null</span><span style="font-size:9pt;color:black;font-family:宋体;">调用</span><span style="font-size:12pt;color:black;font-family:宋体;">send()</span><span style="font-size:9pt;color:black;font-family:宋体;">。因为已经在请求</span><span style="font-size:9pt;color:black;font-family:Verdana;"> URL </span><span style="font-size:9pt;color:black;font-family:宋体;">中添加了要发送给服务器的数据（</span><span style="font-size:9pt;color:black;font-family:Verdana;">city </span><span style="font-size:9pt;color:black;font-family:宋体;">和</span><span style="font-size:9pt;color:black;font-family:Verdana;"> state</span><span style="font-size:9pt;color:black;font-family:宋体;">），所以请求中不需要发送任何数据。这样就发出了请求，服务器按照您的要求工作。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">如果没有发现任何新鲜的东西，您应该体会到这是多么简单明了！除了牢牢记住</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">的异步特性外，这些内容都相当简单。应该感激</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">使您能够专心编写漂亮的应用程序和界面，而不用担心复杂的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> HTTP </span><span style="font-size:9pt;color:black;font-family:宋体;">请求</span><span style="font-size:9pt;color:black;font-family:Verdana;">/</span><span style="font-size:9pt;color:black;font-family:宋体;">响应代码。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:Verdana;"><a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#code5#code5"><u><font color="#0000ff"><span style="font-family:宋体;">清单</span> 5</font></u></a> </span><span style="font-size:9pt;color:black;font-family:宋体;">中的代码说明了</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">的易用性。数据是简单的文本，可以作为请求</span><span style="font-size:9pt;color:black;font-family:Verdana;"> URL </span><span style="font-size:9pt;color:black;font-family:宋体;">的一部分。用</span><span style="font-size:9pt;color:black;font-family:Verdana;"> GET </span><span style="font-size:9pt;color:black;font-family:宋体;">而不是更复杂的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> POST </span><span style="font-size:9pt;color:black;font-family:宋体;">发送请求。没有</span><span style="font-size:9pt;color:black;font-family:Verdana;"> XML </span><span style="font-size:9pt;color:black;font-family:宋体;">和要添加的内容头部，请求体中没有要发送的数据；换句话说，这就是</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">的乌托邦。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">不用担心，随着本系列文章的展开，事情会变得越来越复杂。您将看到如何发送</span><span style="font-size:9pt;color:black;font-family:Verdana;"> POST </span><span style="font-size:9pt;color:black;font-family:宋体;">请求、如何设置请求头部和内容类型、如何在消息中编码</span><span style="font-size:9pt;color:black;font-family:Verdana;"> XML</span><span style="font-size:9pt;color:black;font-family:宋体;">、如何增加请求的安全性，可以做的工作还有很多！暂时先不用管那些难点，掌握好基本的东西就行了，很快我们就会建立一整套的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">工具库。</span></div>
<div style="line-height:14.25pt;" align="left">
<div style="line-height:14.25pt;" align="left"><a><strong><span style="font-size:11.5pt;color:black;font-family:宋体;">处理响应</span></strong></a></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">现在要面对服务器的响应了。现在只要知道两点：</span></div>
<ul>
<li style="color:black;line-height:14.25pt;text-align:left;"><span style="font-size:9pt;font-family:宋体;">什么也不要做，直到</span><span style="font-size:12pt;font-family:宋体;">xmlHttp.readyState</span><span style="font-size:9pt;font-family:宋体;">属性的值等于</span><span style="font-size:9pt;font-family:Arial;"> 4</span><span style="font-size:9pt;font-family:宋体;">。</span>
</li>
<li style="color:black;line-height:14.25pt;text-align:left;"><span style="font-size:9pt;font-family:宋体;">服务器将把响应填充到</span><span style="font-size:12pt;font-family:宋体;">xmlHttp.responseText</span><span style="font-size:9pt;font-family:宋体;">属性中。</span> </li>
</ul>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">其中的第一点，即就绪状态，将在下一篇文章中详细讨论，您将进一步了解</span><span style="font-size:9pt;color:black;font-family:Verdana;"> HTTP </span><span style="font-size:9pt;color:black;font-family:宋体;">请求的阶段，可能比您设想的还多。现在只要检查一个特定的值（</span><span style="font-size:9pt;color:black;font-family:Verdana;">4</span><span style="font-size:9pt;color:black;font-family:宋体;">）就可以了（下一期文章中还有更多的值要介绍）。第二点，使用</span><span style="font-size:12pt;color:black;font-family:宋体;">xmlHttp.responseText</span><span style="font-size:9pt;color:black;font-family:宋体;">属性获得服务器的响应，这很简单。</span><span style="font-size:9pt;color:black;font-family:Verdana;"><a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#code6#code6"><u><font color="#0000ff"><span style="font-family:宋体;">清单</span> 6</font></u></a> </span><span style="font-size:9pt;color:black;font-family:宋体;">中的示例方法可供服务器根据</span><span style="font-size:9pt;color:black;font-family:Verdana;"> <a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#code5#code5"><span style="font-family:宋体;"><font face="宋体"><u><font color="#0000ff"><span>清单</span> 5</font></u></font></span></a> </span><span style="font-size:9pt;color:black;font-family:宋体;">中发送的数据调用。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:Verdana;"><br /></span><a><strong><span style="font-size:9pt;color:black;font-family:宋体;">清单</span></strong></a><strong><span style="font-size:9pt;color:black;font-family:Verdana;"> 6. </span></strong><strong><span style="font-size:9pt;color:black;font-family:宋体;">处理服务器响应</span></strong></div>
<table style="background:#eeeeee;width:100%;" cellspacing="0" cellpadding="0" width="100%" border="1">
<tbody>
<tr>
<td>
<div style="line-height:14.25pt;text-align:left;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">function updatePage() &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;if (xmlHttp.readyState == 4) &#123;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&nbsp;&nbsp; var response = xmlHttp.responseText;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&nbsp;&nbsp; document.getElementById("zipCode").value = response;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&nbsp;&#125;</span></div>
<div style="line-height:14.25pt;text-align:left;" align="left"><span style="font-size:12pt;color:black;font-family:'Lucida Console';">&#125;</span></div>
</td>
</tr>
</tbody>
</table>
<div style="line-height:14.25pt;" align="left">&nbsp;</div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">这些代码同样既不难也不复杂。它等待服务器调用，如果是就绪状态，则使用服务器返回的值（这里是用户输入的城市和州的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> ZIP </span><span style="font-size:9pt;color:black;font-family:宋体;">编码）设置另一个表单字段的值。于是包含</span><span style="font-size:9pt;color:black;font-family:Verdana;"> ZIP </span><span style="font-size:9pt;color:black;font-family:宋体;">编码的</span><span style="font-size:12pt;color:black;font-family:宋体;">zipCode</span><span style="font-size:9pt;color:black;font-family:宋体;">字段突然出现了，而用户<em>没有按任何按钮</em>！这就是前面所说的桌面应用程序的感觉。快速响应、动态感受等等，这些都只因为有了小小的一段</span><span style="font-size:9pt;color:black;font-family:Verdana;"> Ajax </span><span style="font-size:9pt;color:black;font-family:宋体;">代码。</span></div>
<div style="line-height:14.25pt;" align="left"><span style="font-size:9pt;color:black;font-family:宋体;">细心的读者可能注意到</span><span style="font-size:12pt;color:black;font-family:宋体;">zipCode</span><span style="font-size:9pt;color:black;font-family:宋体;">是一个普通的文本字段。一旦服务器返回</span><span style="font-size:9pt;color:black;font-family:Verdana;"> ZIP </span><span style="font-size:9pt;color:black;font-family:宋体;">编码，</span><span style="font-size:12pt;color:black;font-family:宋体;">updatePage()</span><span style="font-size:9pt;color:black;font-family:宋体;">方法就用城市</span><span style="font-size:9pt;color:black;font-family:Verdana;">/</span><span style="font-size:9pt;color:black;font-family:宋体;">州的</span><span style="font-size:9pt;color:black;font-family:Verdana;"> ZIP </span><span style="font-size:9pt;color:black;font-family:宋体;">编码设置那个字段的值，用户就可以改写该值。这样做有两个原因：保持例子简单，说明有时候可能<em>希望</em></span><span style="font-size:9pt;color:black;font-family:宋体;">用户能够修改服务器返回的数据。要记住这两点，它们对于好的用户界面设计来说很重要。</span></div>
<div style="line-height:14.25pt;" align="left">&nbsp;</div>
<table style="width:100%;" cellspacing="0" cellpadding="0" width="100%" border="0">
<tbody>
<tr></tr>
</tbody>
</table>
<table cellspacing="0" cellpadding="0" align="right" border="0">
<tbody>
<tr>
<td>
<div align="right">
<table cellspacing="0" cellpadding="0" border="0">
<tbody>
<tr>
<td valign="top">
<div style="line-height:14.25pt;" align="right"><span style="font-size:9pt;color:black;font-family:Verdana;"><a href="http://www-128.ibm.com/developerworks/cn/xml/wa-ajaxintro1.html#main#main"><strong><span style="font-family:宋体;text-decoration:none;"><font color="#0000ff">回页首</font></span></strong></a></span></div>
</td>
</tr>
</tbody>
</table>
</div>
</td>
</tr>
</tbody>
</table>
<div align="left">&nbsp;</div>
</div>
</div>
</div>
